<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>حاسبة المعدل – الجامعة الهاشمية</title>
<style>
:root{
  --bg:#f4f4f9;
  --card:#fff;
  --text:#111;
  --accent:#1e88e5;
  --input:#f0f0f5;
}
body{
  font-family:sans-serif;
  background: var(--bg);
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:20px;
  color: var(--text);
}
h1{
  margin-bottom:20px;
  color: var(--accent);
  text-align:center;
}
.card{
  background: var(--card);
  padding:20px;
  border-radius:10px;
  box-shadow: 0 6px 15px rgba(0,0,0,0.1);
  max-width:700px;
  width:100%;
  margin-bottom:20px;
}
label{
  display:block;
  margin-top:10px;
}
input, select{
  width:100%;
  padding:8px;
  margin-top:5px;
  border-radius:5px;
  border:1px solid #ccc;
  background: var(--input);
}
button{
  margin-top:15px;
  padding:10px 15px;
  background: var(--accent);
  color:#fff;
  border:none;
  border-radius:5px;
  cursor:pointer;
}
table{
  width:100%;
  margin-top:15px;
  border-collapse: collapse;
}
table, th, td{
  border:1px solid #ccc;
}
th, td{
  padding:8px;
  text-align:center;
}
#result{
  margin-top:15px;
  font-weight:bold;
  font-size:18px;
  text-align:center;
}
h2{
  margin-top:20px;
  color:var(--accent);
  text-align:center;
}
</style>
</head>
<body>

<h1>حاسبة المعدل الفصلي والتراكمي – الجامعة الهاشمية</h1>

<div class="card">
  <label>عدد المواد في هذا الفصل:</label>
  <input type="number" id="numCourses" min="1" max="20" value="5">
  <button onclick="createTable()">إنشاء جدول المواد</button>

  <form id="coursesForm">
    <table id="coursesTable"></table>
    <button type="button" onclick="calculateGPA()">حساب المعدل الفصلي</button>
    <button type="button" onclick="resetForm()">إعادة الحساب</button>
  </form>
  
  <div id="result"></div>
</div>

<div class="card">
  <h2>إدخال بيانات الفصول السابقة</h2>
  <table id="previousSemestersTable">
    <tr>
      <th>رقم الفصل</th>
      <th>المعدل الفصلي</th>
      <th>عدد الساعات المعتمدة</th>
    </tr>
  </table>
  <label>أدخل رقم الفصل:</label>
  <input type="number" id="semesterNum" min="1">
  <label>أدخل المعدل الفصلي:</label>
  <input type="number" id="semesterGPA" min="0" max="4" step="0.01">
  <label>أدخل عدد الساعات المعتمدة:</label>
  <input type="number" id="semesterCredits" min="1">
  <button onclick="addSemester()">إضافة الفصل</button>
  <button onclick="calculateCumulative()">حساب المعدل التراكمي</button>
  <div id="cumulativeResult"></div>
</div>

<script>
// تحويل الدرجة من 100 إلى 4.0
function gradeToPoint(grade){
  if(grade>=90) return 4.0;
  else if(grade>=85) return 3.7;
  else if(grade>=80) return 3.3;
  else if(grade>=75) return 3.0;
  else if(grade>=70) return 2.7;
  else if(grade>=65) return 2.3;
  else if(grade>=60) return 2.0;
  else if(grade>=55) return 1.7;
  else if(grade>=50) return 1.0;
  else return 0;
}

// ----- حساب المعدل الفصلي -----
let currentSolution = [];
function createTable(){
  const num = parseInt(document.getElementById("numCourses").value);
  const table = document.getElementById("coursesTable");
  table.innerHTML="<tr><th>المادة</th><th>الدرجة (0-100)</th><th>الساعات المعتمدة</th></tr>";
  for(let i=0;i<num;i++){
    const row=document.createElement("tr");
    row.innerHTML = `<td>المادة ${i+1}</td>
                     <td><input type="number" min="0" max="100" required></td>
                     <td><input type="number" min="1" max="6" required></td>`;
    table.appendChild(row);
  }
}

function calculateGPA(){
  const rows = document.querySelectorAll("#coursesTable tr:not(:first-child)");
  let totalPoints=0, totalCredits=0;
  rows.forEach(row=>{
    const grade=parseFloat(row.children[1].querySelector("input").value);
    const credit=parseFloat(row.children[2].querySelector("input").value);
    if(isNaN(grade) || isNaN(credit)) return;
    const point = gradeToPoint(grade);
    totalPoints += point * credit;
    totalCredits += credit;
  });
  const gpa = (totalPoints/totalCredits).toFixed(2);
  document.getElementById("result").textContent = `المعدل الفصلي: ${gpa} (على نظام 4.0)`;
}

// ----- إعادة الحساب -----
function resetForm(){
  document.getElementById("coursesTable").innerHTML="";
  document.getElementById("result").textContent="";
}

// ----- حساب المعدل التراكمي -----
let semesters=[];
function addSemester(){
  const num=document.getElementById("semesterNum").value;
  const gpa=parseFloat(document.getElementById("semesterGPA").value);
  const credits=parseFloat(document.getElementById("semesterCredits").value);
  if(!num || isNaN(gpa) || isNaN(credits)) return alert("يرجى إدخال جميع الحقول");
  semesters.push({num,gpa,credits});
  const table=document.getElementById("previousSemestersTable");
  const row=document.createElement("tr");
  row.innerHTML=`<td>${num}</td><td>${gpa}</td><td>${credits}</td>`;
  table.appendChild(row);
  document.getElementById("semesterNum").value="";
  document.getElementById("semesterGPA").value="";
  document.getElementById("semesterCredits").value="";
}

function calculateCumulative(){
  let totalPoints=0,totalCredits=0;
  semesters.forEach(s=>{
    totalPoints += s.gpa * s.credits;
    totalCredits += s.credits;
  });
  const cumGPA = (totalPoints/totalCredits).toFixed(2);
  document.getElementById("cumulativeResult").textContent = `المعدل التراكمي: ${cumGPA}`;
}
</script>

</body>
</html>
